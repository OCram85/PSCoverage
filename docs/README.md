# PSCoverage Module
## Description

This module provides a simple interface to coveralls.io. It enables you to format your coverage reportgenerated by
Pester to upload it.

Unfortunately Pester does not provide any interfaces to upload the coverage reports to external services.Therefore
this module was developed.

### Installing PSCoverage

The easiest way to install this module is to use the PowerShell built in package management. Therefore use
`Import-Module 'PowerShellGet'; Install-Module -Name 'PSCoverage' -Repository 'PSGallery'` to get the latest release
from [PowerShellGallery Repository](https://powershellgallery.com).

### Getting Started

Navigate to your module/ repository root. Your module structure needs to be like this:

```console
~\src\
      Private\
              Invoke-Foobar.ps1
      Functions\
      External\
~\tests\
        Private\
                Invoke-Foobar.Tests.ps1
        Functions\
        External\
~\ModuleManifest.psd1
~\ModuleScript.psm1
```

**1.** First you need a list of all your src files:

```powershell
$srcFiles = Get-ChildItem -Path ".\src\*.ps1" -Recurse | Sort-Object -Property 'Name' | Select-Object -ExpandProperty 'FullName'
```

**2.** Next you need a list with all your pester tests files:

```powershell
$testFiles = Get-ChildItem -Path ".\tests\*.Tests.ps1" -Recurse | Sort-Object -Property 'Name' | Select-Object -ExpandProperty 'FullName'
```

**3.** The simplest way to get you code coverage is by creating it with your unit tests. This avoids rerunning all
the test with PSCoverage:

```powershell
$TestResults = Invoke-Pester -Path $testFiles -CodeCoverage $srcFiles -PassThru
```

**4.** And then passthru the code coverage to create a new report:

```powershell
$CoverallsIOReport = New-CoverageReport -CodeCoverage $TestResults.CodeCoverage -RepoToken '123456' -ModuleRoot $PWD
```

**5.** Finally we can upload the coverage report to coveralls.io:

```powershell
Publish-CoverageReport -CoverageReport $CoverallsIOReport
```

## PSCoverage Cmdlets
### [New-CoverageReport](New-CoverageReport.md)
Creates a CoverallsIO coverage report based on pester data.

### [Publish-CoverageReport](Publish-CoverageReport.md)
Uploads a given CoverageReport to coveralls.io.
